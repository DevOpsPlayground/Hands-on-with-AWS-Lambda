<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Lambda Lab</title>
<link rel="stylesheet" href="css/reset.css" />
<link rel="stylesheet" href="css/text.css" />
<link rel="stylesheet" href="css/960_24_col.css" />
<link rel="stylesheet" href="css/meetup_base.css" />
<link rel="stylesheet" href="css/markdown.css" />
</head>

<body>
  <div class="container_24">
    <h2 class="homeTitle">
      Serverless Lab
    </h2>
    <div class="grid_24 nav">
      <p>
      <ul style="display: inline;  margin: 0; list-style-type: none;">
        <li><a href="index.html">Home</a></li>
        <li><a href="cors.html">CORS</a></li>
        <li><a href="apigw.html">API Gateway</a></li>
        <li><a href="maptempl.html">Mapping Template</a></li>
        <li><a href="kinesis.html">Kinesis</a></li>
        <li><a href="README.md.html">Labs: README</a></li>
      </ul>
      </p>
      <hr/>
    </div>

    <div class="grid_24 markdown-preview ">


      <h1><a id="user-content-hands-on-serverless-computing-with-lambda" class="anchor" href="#hands-on-serverless-computing-with-lambda" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hands On Serverless Computing with Lambda</h1>
      <p>The topics for this hands-on session will be AWS Lambda, function as a service (FaaS). During this Playground you will create a website hosted on AWS S3 using AWS Lambda and Amazon API Gateway to add dynamic functionality to the site.</p>
      <ol>
      <li><a href="https://github.com/ForestTechnologiesLtd/devopsplayground11-lambda">GitHub - README.md</a></li>
      <li><a href="http://meetup.playground11.s3-website-us-west-2.amazonaws.com/index.html">Labs Static Website sample</a></li>
      <li>All labs were done in US Oregon Region</li>
      </ol>
      <h2><a id="user-content-labs" class="anchor" href="#labs" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Labs</h2>
      <ol>
      <li>001 - Build Static Website with s3 Bucket</li>
      <li>002 - CORS - Sharing resources between s3 Buckets</li>
      <li>003 - Web Services with Lambda (Python)</li>
      <li>004 - Posting Data with Lambda</li>
      <li>005 - Kinesis - Realtime Data Processing</li>
      </ol>
      <h4><a id="user-content-login" class="anchor" href="#login" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Login</h4>
      <ul>
      <li><strong>AWS Console:</strong> <code>https://devopsplayground.signin.aws.amazon.com/console</code></li>
      <li><strong>Username:</strong> <code>&lt;TBA&gt;</code></li>
      <li><strong>Password:</strong> <code>&lt;TBA&gt;</code></li>
      </ul>
      <h4><a id="user-content-prerequisites" class="anchor" href="#prerequisites" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites</h4>
      <ul>
      <li>Login to AWS account</li>
      <li>Permissions to create S3 Buckets</li>
      <li>Permissions to write and execute lambda functions</li>
      <li><strong>Region:</strong> Oregon</li>
      </ul>
      <h4><a id="user-content-checkout-code-from-github" class="anchor" href="#checkout-code-from-github" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Checkout code from GitHub</h4>
      <div class="highlight highlight-source-shell"><pre>git clone https://github.com/ForestTechnologiesLtd/devopsplayground11-lambda.git
      <span class="pl-c1">cd</span> devopsplayground11-lambda</pre></div>
      <h1><a id="user-content-lab-001---build-static-website-with-s3-bucket" class="anchor" href="#lab-001---build-static-website-with-s3-bucket" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lab-001 - Build Static Website with s3 Bucket</h1>
      <p><strong>Goal:</strong> Create a static website using s3 bucket</p>
      <p><strong>AWS Services:</strong> S3 (Static Web hosting)</p>
      <p><a href="https://raw.githubusercontent.com/ForestTechnologiesLtd/devopsplayground11-lambda/master/diagrams/pg11-lab-001.png" target="_blank"><img src="https://raw.githubusercontent.com/ForestTechnologiesLtd/devopsplayground11-lambda/master/diagrams/pg11-lab-001.png" alt="lab-001 Static Website" style="max-width:100%;"></a></p>
      <div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> lab-001_website</pre></div>
      <ol>
      <li>Create a new s3 Bucket</li>
      <li><strong>Name and region</strong>
      <ul>
      <li><strong>Name:</strong> <code>&lt;your name&gt;.playground11</code></li>
      <li><strong>Region:</strong> <code>US West (Oregon)</code></li>
      <li><strong>Copy settings from an existing bucket:</strong> Leave blank</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Properties:</strong>
      <ul>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Permissions:</strong>
      <ul>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Review:</strong>
      <ul>
      <li>Click 'Create Bucket'</li>
      </ul>
      </li>
      <li>Upload files from folder <code>lab-001_website</code></li>
      <li><strong>Select files</strong>
      <ul>
      <li>(all files minus <code>css</code> folder)</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Permissions</strong>
      <ul>
      <li>Manage Group Permissions &gt; Everyone (Read)/Make public</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Properties</strong>
      <ul>
      <li>Click 'Upload'</li>
      </ul>
      </li>
      <li>Create subfolder <code>css</code> using S3 web console</li>
      <li>Goto bucket <code>&lt;your name&gt;.playground11</code>
      <ul>
      <li>Click Create folder</li>
      <li><strong>Name:</strong> <code>css</code></li>
      <li>Click 'Save'</li>
      </ul>
      </li>
      <li>Upload remaining files from <code>css</code> folder same steps as 2.</li>
      <li>Enable <strong>Staitic website hosting</strong>
      <ul>
      <li>Properties &gt; Static website hosting</li>
      </ul>
      </li>
      <li>Select 'Use this bucket to host a Website'
      <ul>
      <li><strong>Index document:</strong> index.html</li>
      <li><strong>Error document:</strong> error.html</li>
      <li>Click 'Save'</li>
      </ul>
      </li>
      <li>Open the <strong>Endpoint</strong> in a web browser.
      <ul>
      <li><code>http://&lt;your name&gt;.playground11.s3-website-us-west-2.amazonaws.com</code></li>
      </ul>
      </li>
      <li>Lab End.</li>
      </ol>
      <h1><a id="user-content-lab-002---cors---sharing-resources-between-s3-buckets" class="anchor" href="#lab-002---cors---sharing-resources-between-s3-buckets" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lab-002 - CORS - Sharing resources between s3 Buckets</h1>
      <p><strong>Goal:</strong> Share resources from another s3 bucket with website from <strong>lab-001_website</strong>.</p>
      <p><strong>AWS Services:</strong> S3 (Static Web hosting, CORS)</p>
      <p><a href="https://raw.githubusercontent.com/ForestTechnologiesLtd/devopsplayground11-lambda/master/diagrams/pg11-lab-002.png" target="_blank"><img src="https://raw.githubusercontent.com/ForestTechnologiesLtd/devopsplayground11-lambda/master/diagrams/pg11-lab-002.png" alt="lab-002 Static Website using CORS" style="max-width:100%;"></a></p>
      <div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> lab-002_cors</pre></div>
      <ol>
      <li>Edit the file <code>cors.html</code> change the link and replace it with the text <strong>YOUR_NAME</strong> with your bucket name.
      <ul>
      <li><strong>REPLACE:</strong> YOUR_NAME.playground11</li>
      <li><strong>WITH:</strong> .playground11</li>
      </ul>
      <div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span>&gt;<span class="pl-s1"></span>
      <span class="pl-s1">  <span class="pl-en">$</span>(<span class="pl-c1">document</span>).<span class="pl-en">ready</span>(<span class="pl-k">function</span>(){</span>
      <span class="pl-s1">      <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>button<span class="pl-pds">"</span></span>).<span class="pl-c1">click</span>(<span class="pl-k">function</span>(){</span>
      <span class="pl-s1">          <span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">"</span>#s3_cors<span class="pl-pds">"</span></span>).<span class="pl-c1">load</span>(<span class="pl-s"><span class="pl-pds">"</span>http://YOUR_NAME.playground11.s3-website-us-west-2.amazonaws.com/demo_text.txt<span class="pl-pds">"</span></span>);</span>
      <span class="pl-s1">      });</span>
      <span class="pl-s1">  });</span>
      <span class="pl-s1"></span><span class="pl-s1">&lt;</span>/<span class="pl-ent">script</span>&gt;</pre></div>
      </li>
      <li>Upload files from <code>cors.html, demo_text.html</code> folder <code>lab-002_website</code> to bucket <code>&lt;your name&gt;.playground11</code> your static website from <strong>Lab-001</strong>.
      <ol>
      <li><strong>Select files</strong>
      <ul>
      <li>(<code>cors.html, demo_text.txt</code>)</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Permissions</strong>
      <ul>
      <li>Manage Group Permissions &gt; Everyone (Read)/Make public</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Properties</strong>
      <ul>
      <li>Accept defaults, click 'Upload'</li>
      </ul>
      </li>
      </ol>
      <ul>
      <li>Click 'Save'</li>
      </ul>
      </li>
      <li>Open the <strong>Endpoint</strong> in a web browser.
      <ul>
      <li><code>http://&lt;your name&gt;.playground11.s3-website-us-west-2.amazonaws.com</code></li>
      </ul>
      </li>
      <li>With a web browser visit the static website from <strong>Lab-001</strong> and click on the menu item 'CORS' the <strong>RED</strong> text <strong>"LAB NOT STARTED"</strong> should disappeared if not refresh the web page.</li>
      <li>Click on the button <strong>Get External Content</strong>. Javascript code you edited at the start of this lab has now pull text from the file <code>demo_text</code>.</li>
      </ol>
      <p>In order to understand CORS (Cross Origin Resource Sharing) you need to create another bucket, which this lab will pull resources from.</p>
      <ol>
      <li>Create a new s3 Bucket
      <ol>
      <li><strong>Name and region</strong>
      <ul>
      <li><strong>Name:</strong> <code>&lt;your name&gt;.cors.playground11</code></li>
      <li><strong>Region:</strong> <code>US West (Oregon)</code></li>
      <li><strong>Copy settings from an existing bucket:</strong> Leave blank</li>
      </ul>
      </li>
      <li><strong>Set Properties:</strong>
      <ul>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Permissions:</strong>
      <ul>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Review:</strong>
      <ul>
      <li>Click 'Create Bucket'</li>
      </ul>
      </li>
      </ol>
      </li>
      <li>Upload files from the folder <code>lab-002_cors\cors_bucket</code> to your new bucket <code>&lt;your name&gt;.cors.playground11</code>
      <ol>
      <li><strong>Select files</strong>
      <ul>
      <li>(<code>cors_demo_text.txt, index.html, error.html</code>)</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Permissions</strong>
      <ul>
      <li>Manage Group Permissions &gt; Everyone (Read)/Make public</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Properties</strong>
      <ul>
      <li>Accept defaults, click 'Upload'</li>
      </ul>
      </li>
      </ol>
      </li>
      <li>Enable <strong>Staitic website hosting</strong>
      <ul>
      <li>Properties &gt; Static website hosting</li>
      </ul>
      </li>
      <li>Select 'Use this bucket to host a Website'
      <ul>
      <li><strong>Index document:</strong> index.html</li>
      <li><strong>Error document:</strong> error.html</li>
      <li>Click 'Save'</li>
      </ul>
      </li>
      <li>Open the <strong>Endpoint</strong> in a web browser.
      <ul>
      <li><code>http://&lt;your name&gt;.cors.playground11.s3-website-us-west-2.amazonaws.com</code></li>
      </ul>
      </li>
      <li>Edit the file <code>lab-002_cors\cors.html</code> change the Javascript link again to the new link from the new S3 bucket website.
      <ul>
      <li><strong>REPLACE:</strong> <code>YOUR_NAME.playground11</code></li>
      <li><strong>WITH:</strong> <code>&lt;YOUR NAME&gt;.cors.playground11</code></li>
      <li><strong>NOTE:</strong> The filename change at end of url: <code>cors_demo_text.txt</code></li>
      </ul>
      <pre><code>&lt;script type="text/javascript"&gt;
      $(document).ready(function(){
          $("button").click(function(){
              $("#s3_cors").load("http://YOUR_NAME.cors.playground11.s3-website-us-west-2.amazonaws.com/cors_demo_text.txt");
          });
      });
      &lt;/script&gt;
      </code></pre>
      </li>
      <li>Click on the button <strong>Get External Content</strong>. You will notice that nothing happens. If you Enable the Javascript console you notice in Safari the error:
      <pre><code>[Error] Origin http://meetup.playground11.s3-website-us-west-2.amazonaws.com is not allowed by Access-Control-Allow-Origin.
      [Error] Failed to load resource: Origin http://meetup.playground11.s3-website-us-west-2.amazonaws.com is not allowed by Access-Control-Allow-Origin. (cors_demo_text.txt, line 0)
      [Error] XMLHttpRequest cannot load http://meetup.cors.playground11.s3-website-us-west-2.amazonaws.com/cors_demo_text.txt due to access control checks.
      </code></pre>
      This occurs because web browsers expect resources to be requested from the same domain. To resolve this issue AWS S3 has a feature called CORS (Cross Origin Resource Sharing) if you enable this feature this will allow the webpage to request the content from another bucket.</li>
      <li>With bucket <code>&lt;your name&gt;.cors.playground11</code> enable CORS configuration, add a new policy.
      <ul>
      <li>Permissions &gt; CORS configuration</li>
      <li><strong>NOTE:</strong> Replace url in <code>&lt;AllowedOrigin&gt;</code> tag with your static website link from lab-001.</li>
      </ul>
      <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
      &lt;CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/"&gt;
      &lt;CORSRule&gt;
          &lt;AllowedOrigin&gt;http://&lt;your name&gt;.playground11.s3-website-us-west-2.amazonaws.com&lt;/AllowedOrigin&gt;
          &lt;AllowedMethod&gt;GET&lt;/AllowedMethod&gt;
          &lt;MaxAgeSeconds&gt;3000&lt;/MaxAgeSeconds&gt;
          &lt;AllowedHeader&gt;Authorization&lt;/AllowedHeader&gt;
      &lt;/CORSRule&gt;
      &lt;/CORSConfiguration&gt;
      </code></pre>
      <ul>
      <li>Click "Save"</li>
      </ul>
      </li>
      <li>Click on the button Get External Content. You will see <strong>CORS Working....!</strong> now.</li>
      <li>Lab End.</li>
      </ol>
      <h1><a id="user-content-lab-003---web-services-with-lambda-python" class="anchor" href="#lab-003---web-services-with-lambda-python" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lab-003 - Web Services with Lambda (Python)</h1>
      <p><strong>Goal:</strong> Create a lambda function that generates a random number and expose the function as a web service via API Gateway.</p>
      <p><strong>AWS Services:</strong> S3, Lambda, API Gateway,</p>
      <p><a href="https://raw.githubusercontent.com/ForestTechnologiesLtd/devopsplayground11-lambda/master/diagrams/pg11-lab-003.png" target="_blank"><img src="https://raw.githubusercontent.com/ForestTechnologiesLtd/devopsplayground11-lambda/master/diagrams/pg11-lab-003.png" alt="lab-003 Static Website with API Gateway and Lambda" style="max-width:100%;"></a></p>
      <h5><a id="user-content-create-lambda-function" class="anchor" href="#create-lambda-function" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create Lambda function</h5>
      <ol>
      <li>Services &gt; Compute &gt; Lambda</li>
      <li>Create New function
      <ol>
      <li><strong>Select blueprint</strong>
      <ul>
      <li>Select runtime: python 2.7</li>
      <li>Filter: hello-world-python</li>
      </ul>
      </li>
      <li><strong>Configure triggers</strong>
      <ul>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Configure function</strong>
      <ul>
      <li>Name: <code>&lt;your name&gt;_generateRandomNumber</code></li>
      <li>Description: Function that generates a random number between 0 and 100</li>
      <li>Runtime: Python 2.7</li>
      <li>Lambda function code: Copy and Paste the code from file <code>lab-003_lambda\getSimpleRandomNumber.py</code> into the window. Leave the <strong>Code entry type: Edit code inline</strong>.</li>
      <li><strong>Lambda function handler and role</strong>
      <ul>
      <li><strong>Handler:</strong> <code>lambda_function.lambda_handler</code></li>
      <li><strong>Role*:</strong> Choose an existing role</li>
      <li><strong>Existing role*:</strong> <code>lambdaExecutionRole</code></li>
      </ul>
      </li>
      <li>Accept Defaults for other settings</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Review</strong>
      <ul>
      <li>Click 'Create function'</li>
      <li><strong>NOTE:</strong> Congratulations! Your Lambda function "meetup_generateRandomNumber" has been successfully created. You can now click on the "Test" button to input a test event and test your function.</li>
      </ul>
      </li>
      </ol>
      </li>
      <li>Testing your function
      <ul>
      <li>Click 'Test'</li>
      <li>Input test event
      <ul>
      <li>Sample event template : Hello World</li>
      </ul>
      <div class="highlight highlight-source-json"><pre>{}</pre></div>
      <ul>
      <li>Click 'Save and test'</li>
      <li>You will see the message <strong>Execution result: succeeded(logs)</strong> and a random number in a box with a dotted line.</li>
      </ul>
      </li>
      </ul>
      </li>
      <li>View Lambda logs
      <ul>
      <li>Click the link 'logs' in the title labeled <strong>Execution result: succeeded(logs)</strong></li>
      <li>Click the log Group and look for the line: <code>Random No. [ 21 ]</code>. As the number is random it should look similar.</li>
      </ul>
      </li>
      </ol>
      <p><strong>lambda_function.lambda_handler</strong></p>
      <div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> <span class="pl-c1">__future__</span> <span class="pl-k">import</span> print_function
      <span class="pl-k">from</span> random <span class="pl-k">import</span> randint

      <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">'</span>Loading function<span class="pl-pds">'</span></span>)

      <span class="pl-k">def</span> <span class="pl-en">lambda_handler</span>(<span class="pl-smi">event</span>, <span class="pl-smi">context</span>):
          myNumber <span class="pl-k">=</span> randint(<span class="pl-c1">0</span>,<span class="pl-c1">100</span>)
          <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">"</span>Random No. [ <span class="pl-c1">%s</span> ]<span class="pl-pds">"</span></span> <span class="pl-k">%</span> myNumber)
          <span class="pl-k">return</span> myNumber
      </pre></div>
      <h4><a id="user-content-exposing-lambda-via-api-gateway" class="anchor" href="#exposing-lambda-via-api-gateway" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exposing Lambda via API Gateway</h4>
      <ol>
      <li>Create new API
      <ul>
      <li>Check 'New API'</li>
      <li><strong>Name:</strong> <code>&lt;your name&gt;pg11</code></li>
      <li><strong>Description:</strong> test lab api</li>
      <li>Click 'Create API'</li>
      </ul>
      </li>
      <li>Add a New Child Resource
      <ul>
      <li>APIs &gt; <code>&lt;your name&gt;pg11</code> &gt; Resources</li>
      <li><strong>Configure as proxy resource:</strong> Leave blank</li>
      <li><strong>Resource Name:</strong> Random Number</li>
      <li><strong>Resource Path:</strong> <code>/random-number</code></li>
      <li><strong>Enable API Gateway CORS:</strong> Yes</li>
      </ul>
      </li>
      <li>Add a GET method to resource <strong>/random-number</strong>
      <ul>
      <li>Actions &gt; Create Method</li>
      <li>Under the resource a drop down will appear select <strong>GET</strong> method and click the 'tick'.</li>
      </ul>
      </li>
      <li>/random-number <strong>GET</strong> - Setup
      <ul>
      <li><strong>Integration type:</strong> Lambda Function</li>
      <li><strong>Use Lambda Proxy integration:</strong> Leave blank</li>
      <li><strong>Lambda Region:</strong> <code>us-west-2</code></li>
      <li><strong>Lambda Function:</strong> <code>&lt;your name&gt;_generateRandomNumber</code></li>
      <li>Click 'Save'
      <ul>
      <li>Confirm the dialog 'Add Permission to Lambda Function', Click 'OK'</li>
      </ul>
      </li>
      </ul>
      </li>
      </ol>
      <h4><a id="user-content-testing-lambda-via-api-gateway" class="anchor" href="#testing-lambda-via-api-gateway" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Testing Lambda via API Gateway</h4>
      <ol>
      <li>Click <strong>GET</strong> method under <strong>/random-number</strong></li>
      <li>Click <strong>TEST</strong> link in the box labeled 'Client</li>
      <li>At the bottom of the new view Click 'Test' button</li>
      <li>Under <strong>Response Body</strong> you should see a random number. Click the blue button labelled 'Test' again at the bottom of the screen and you will see a new number appear.</li>
      <li>Test completed successfully</li>
      </ol>
      <h4><a id="user-content-deploy-api" class="anchor" href="#deploy-api" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy API</h4>
      <ol>
      <li>Click Resources select <strong>/</strong></li>
      <li>Select <strong>Actions</strong> and select <strong>Deploy API</strong>
      <ul>
      <li>Deploy API</li>
      <li><strong>Deployment stage:</strong> [New Stage]
      <ul>
      <li><strong>Stage Name:</strong> dev</li>
      <li><strong>Stage description:</strong> Pre-production development stage</li>
      </ul>
      </li>
      <li><strong>Deployment description:</strong></li>
      </ul>
      </li>
      <li><strong>Remember Invoke URL:</strong> <code>https://3xtidh28cf.execute-api.us-west-2.amazonaws.com/dev</code></li>
      </ol>
      <h4><a id="user-content-test-api-deployment" class="anchor" href="#test-api-deployment" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Test API Deployment</h4>
      <ol>
      <li>Entering the Invoke URL into the web browser.
      <ul>
      <li><strong>NOTE:</strong> You will have to enter the method name e.g. <code>/random-number</code> to the end of the <em><strong>Invoke URL</strong></em></li>
      <li><code>https://3xtidh28cf.execute-api.us-west-2.amazonaws.com/dev/random-number</code></li>
      </ul>
      </li>
      <li>You should see a random number appear in the web browser.</li>
      </ol>
      <h4><a id="user-content-integrate-api-into-static-website" class="anchor" href="#integrate-api-into-static-website" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Integrate API into static website</h4>
      <div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> lab-003_lambda</pre></div>
      <ol>
      <li>Edit the file <code>apigw.html</code> change the link and replace replace the string 'MY_API_GW_REQUEST' with the API Gateway Invoke URL with method name <code>/random-number</code> in it. e.g. <code>https://3xtidh28cf.execute-api.us-west-2.amazonaws.com/dev/random-number</code></li>
      <li>Update the file to S3 bucket <code>&lt;Your name&gt;.playground11</code> remember to set read permission for everyone.</li>
      <li>load the website in a web browser</li>
      <li>Click the button labelled 'Get External Content'
      <ul>
      <li><strong>IT WILL FAIL...!</strong></li>
      <li>View Javascript in your website and you'll see message like <code>CORS header 'Access-Control-Allow-Origin' missing</code>.
      <ul>
      <li>Previous lab we did a example of CORS we need to enable the API here to all the website to access the link from a diffent site.</li>
      </ul>
      </li>
      </ul>
      </li>
      <li><code>/random-number</code>, <strong>GET</strong> method then Actions &gt; <strong>Enable CORS</strong></li>
      <li>You need to redeploy the API, <strong>Deploy API</strong>
      <ul>
      <li><strong>Development stage:</strong> dev</li>
      <li><strong>Development description:</strong> lab-003</li>
      </ul>
      </li>
      <li>Refesh the web page, <strong>API Gateway</strong>
      <ul>
      <li>press button <strong>Get External Content</strong></li>
      </ul>
      </li>
      <li>Lab End.</li>
      </ol>
      <h1><a id="user-content-lab-004---posting-data-with-lambda" class="anchor" href="#lab-004---posting-data-with-lambda" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lab-004 - Posting Data with Lambda</h1>
      <p><strong>Goal:</strong> Using a form a the s3 Bucket website that is processed using Lambda. You will upload a form to the website and write a lambda function and expose that function using API Gateway using mapping tempaltes to process the POST from the form.</p>
      <p><strong>AWS Services:</strong> S3, Lambda, API Gateway,</p>
      <p><a href="https://raw.githubusercontent.com/ForestTechnologiesLtd/devopsplayground11-lambda/master/diagrams/pg11-lab-004.png" target="_blank"><img src="https://raw.githubusercontent.com/ForestTechnologiesLtd/devopsplayground11-lambda/master/diagrams/pg11-lab-004.png" alt="lab-004 Static Website with API Gateway and Lambda and using API Gatway Mapping Template" style="max-width:100%;"></a></p>
      <h4><a id="user-content-create-lambda-function-1" class="anchor" href="#create-lambda-function-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create Lambda function</h4>
      <ol>
      <li>Services &gt; Compute &gt; Lambda</li>
      <li>Create New function
      <ol>
      <li><strong>Select blueprint</strong>
      <ul>
      <li>Select runtime: python 2.7</li>
      <li>Filter:</li>
      </ul>
      </li>
      <li><strong>Configure triggers</strong>
      <ul>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Configure function</strong>
      <ul>
      <li>Name: <code>&lt;your name&gt;_myHelloMsg</code></li>
      <li>Description: Function that presents a nice greeting</li>
      <li>Runtime: Python 2.7</li>
      <li>Lambda function code: Copy and Paste the code from file <code>lab-004_lambda\myHelloMsg.py</code> into the window. Leave the <strong>Code entry type: Edit code inline</strong>.</li>
      </ul>
      <div class="highlight highlight-source-python"><pre><span class="pl-k">def</span> <span class="pl-en">lambda_handler</span>(<span class="pl-smi">event</span>, <span class="pl-smi">context</span>):
          <span class="pl-c"><span class="pl-c">#</span> <span class="pl-k">TODO</span> implement</span>
          <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">"</span>Event is <span class="pl-c1">%s</span><span class="pl-pds">"</span></span> <span class="pl-k">%</span> event)
          name <span class="pl-k">=</span> event.get(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>) <span class="pl-k">or</span> <span class="pl-s"><span class="pl-pds">"</span>No msg submitted<span class="pl-pds">"</span></span>
          <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>Hello from Lambda: <span class="pl-c1">%s</span> <span class="pl-pds">"</span></span> <span class="pl-k">%</span> (name)</pre></div>
      <ul>
      <li><strong>Lambda function handler and role</strong>
      <ul>
      <li><strong>Handler:</strong> <code>lambda_function.lambda_handler</code></li>
      <li><strong>Role*:</strong> Choose an existing role</li>
      <li><strong>Existing role*:</strong> <code>lambdaExecutionRole</code></li>
      </ul>
      </li>
      <li>Accept Defaults for other settings</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Review</strong>
      <ul>
      <li>Click 'Create function'</li>
      <li><strong>NOTE:</strong> Congratulations! Your Lambda function "meetup_generateRandomNumber" has been successfully created. You can now click on the "Test" button to input a test event and test your function.</li>
      </ul>
      </li>
      </ol>
      </li>
      <li>Testing your function
      <ul>
      <li>Click 'Test'</li>
      <li>Input test event
      <ul>
      <li>Sample event template : Hello World</li>
      </ul>
      <div class="highlight highlight-source-json"><pre>{
          <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>Hello is it me your looking for...<span class="pl-pds">"</span></span>
      }</pre></div>
      <ul>
      <li>Click 'Save and test'</li>
      <li>You will see the message <strong>Execution result: succeeded(logs)</strong> dotted line box the output from the function: "Hello from Lambda: Hello is it mean your looking for... "</li>
      </ul>
      </li>
      </ul>
      </li>
      <li>View Lambda logs
      <ul>
      <li>Click the link 'logs' in the title labeled <strong>Execution result: succeeded(logs)</strong></li>
      <li>Click the log Group and look for the line: <code>Event is {u'name': u'Hello is it mean your looking for...'}</code>.</li>
      </ul>
      </li>
      </ol>
      <h4><a id="user-content-configuring-api-gateway" class="anchor" href="#configuring-api-gateway" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuring API Gateway</h4>
      <h4><a id="user-content-setup-new-resource-hello" class="anchor" href="#setup-new-resource-hello" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setup New Resource /hello</h4>
      <ol>
      <li>Create New Resource on /
      <ul>
      <li>APIs &gt; <code>&lt;your name&gt;pg11</code> &gt; Resources</li>
      <li><strong>Configure as proxy resource:</strong> Leave blank</li>
      <li><strong>Resource Name:</strong> hello</li>
      <li><strong>Resource Path:</strong> <code>/hello</code></li>
      <li><strong>Enable API Gateway CORS:</strong> Yes</li>
      <li>Click 'Create Resource'</li>
      </ul>
      </li>
      </ol>
      <h4><a id="user-content-hello---get---integration-request" class="anchor" href="#hello---get---integration-request" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>/hello - GET - Integration Request</h4>
      <ol>
      <li>Add a GET method to resource <strong>/hello</strong>
      <ul>
      <li>Click Resource '/hello'</li>
      <li>Actions &gt; Create Method</li>
      <li>Under the resource a drop down will appear select <strong>GET</strong> method and click the 'tick'.</li>
      </ul>
      </li>
      <li>/hello <strong>GET</strong> - Setup
      <ul>
      <li>Click '/hello' GET Resource</li>
      <li><strong>Integration type:</strong> Lambda Function</li>
      <li><strong>Use Lambda Proxy integration:</strong> Leave blank</li>
      <li><strong>Lambda Region:</strong> <code>us-west-2</code></li>
      <li><strong>Lambda Function:</strong> <code>&lt;your name&gt;_myHelloMsg</code></li>
      <li>Click 'Save'
      <ul>
      <li>Confirm the dialog 'Add Permission to Lambda Function', Click 'OK'</li>
      </ul>
      </li>
      </ul>
      </li>
      <li>Method Execution - GET
      <ul>
      <li>Click 'Integration Request'</li>
      <li><strong>Integation type:</strong> Lambda Function</li>
      <li><strong>Use Lambda Proxy integration:</strong> Leave Blank</li>
      <li><strong>Lambda Region:</strong> <code>us-west-2</code></li>
      <li><strong>Lambda Function:</strong> <code>&lt;your name&gt;_myHelloMsg</code></li>
      <li><strong>Invoke with caller credentials:</strong> Leave Blank</li>
      <li><strong>Credentials cache:</strong> Do not add caller credentials to cache key</li>
      </ul>
      </li>
      <li>Body Mapping Templates - GET
      <ul>
      <li><strong>Request body passthrough:</strong> When there are no templates defined (recommended)</li>
      <li>Add Mapping Template:</li>
      <li><strong>Content-Type:</strong> <code>application/json</code></li>
      <li><strong>Body Mapping Template</strong></li>
      </ul>
      <div class="highlight highlight-source-json"><pre>{
          <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>$input.params('name')<span class="pl-pds">"</span></span>
      }</pre></div>
      <ul>
      <li>Click 'Save'</li>
      </ul>
      </li>
      </ol>
      <h4><a id="user-content-hello---post---integration-request" class="anchor" href="#hello---post---integration-request" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>/hello - POST - Integration Request</h4>
      <ol>
      <li>
      <p>Add a POST method to resource <strong>/hello</strong></p>
      <ul>
      <li>Click Resource '/hello'</li>
      <li>Actions &gt; Create Method</li>
      <li>Under the resource a drop down will appear select <strong>POST</strong> method and click the 'tick'.</li>
      </ul>
      </li>
      <li>
      <p>/hello <strong>POST</strong> - Setup</p>
      <ul>
      <li>Click '/hello' POST Resource</li>
      <li><strong>Integration type:</strong> Lambda Function</li>
      <li><strong>Use Lambda Proxy integration:</strong> Leave blank</li>
      <li><strong>Lambda Region:</strong> <code>us-west-2</code></li>
      <li><strong>Lambda Function:</strong> <code>&lt;your name&gt;_myHelloMsg</code></li>
      <li>Click 'Save'
      <ul>
      <li>Confirm the dialog 'Add Permission to Lambda Function', Click 'OK'</li>
      </ul>
      </li>
      </ul>
      </li>
      <li>
      <p>Method Execution - POST</p>
      <ul>
      <li><strong>Integation type:</strong> Lambda Function</li>
      <li><strong>Use Lambda Proxy integration:</strong> Leave Blank</li>
      <li><strong>Lambda Region:</strong> <code>us-west-2</code></li>
      <li><strong>Lambda Function:</strong> <code>&lt;your name&gt;_myHelloMsg</code></li>
      <li><strong>Invoke with caller credentials:</strong> Leave Blank</li>
      <li><strong>Credentials cache:</strong> Do not add caller credentials to cache key</li>
      </ul>
      </li>
      <li>
      <p>Body Mapping Templates - POST</p>
      <ul>
      <li><strong>Request body passthrough:</strong> When there are no templates defined (recommended)</li>
      <li>Add Mapping Template:</li>
      <li><strong>Content-Type:</strong> <code>application/x-www-form-urlencoded</code></li>
      <li><strong>Body Mapping Template</strong></li>
      </ul>
      <pre lang="velocity"><code>## convert HTML POST data or HTTP GET query string to JSON

      ## get the raw post data from the AWS built-in variable and give it a nicer name
      #if ($context.httpMethod == "POST")
       #set($rawAPIData = $input.path('$'))
      #elseif ($context.httpMethod == "GET")
       #set($rawAPIData = $input.params().querystring)
       #set($rawAPIData = $rawAPIData.toString())
       #set($rawAPIDataLength = $rawAPIData.length() - 1)
       #set($rawAPIData = $rawAPIData.substring(1, $rawAPIDataLength))
       #set($rawAPIData = $rawAPIData.replace(", ", "&amp;"))
      #else
       #set($rawAPIData = "")
      #end

      ## first we get the number of "&amp;" in the string, this tells us if there is more than one key value pair
      #set($countAmpersands = $rawAPIData.length() - $rawAPIData.replace("&amp;", "").length())

      ## if there are no "&amp;" at all then we have only one key value pair.
      ## we append an ampersand to the string so that we can tokenise it the same way as multiple kv pairs.
      ## the "empty" kv pair to the right of the ampersand will be ignored anyway.
      #if ($countAmpersands == 0)
       #set($rawPostData = $rawAPIData + "&amp;")
      #end

      ## now we tokenise using the ampersand(s)
      #set($tokenisedAmpersand = $rawAPIData.split("&amp;"))

      ## we set up a variable to hold the valid key value pairs
      #set($tokenisedEquals = [])

      ## now we set up a loop to find the valid key value pairs, which must contain only one "="
      #foreach( $kvPair in $tokenisedAmpersand )
       #set($countEquals = $kvPair.length() - $kvPair.replace("=", "").length())
       #if ($countEquals == 1)
        #set($kvTokenised = $kvPair.split("="))
        #if ($kvTokenised[0].length() &gt; 0)
         ## we found a valid key value pair. add it to the list.
         #set($devNull = $tokenisedEquals.add($kvPair))
        #end
       #end
      #end

      ## next we set up our loop inside the output structure "{" and "}"
      {
      #foreach( $kvPair in $tokenisedEquals )
        ## finally we output the JSON for this pair and append a comma if this isn't the last pair
        #set($kvTokenised = $kvPair.split("="))
       "$util.urlDecode($kvTokenised[0])" : #if($kvTokenised[1].length() &gt; 0)"$util.urlDecode($kvTokenised[1])"#{else}""#end#if( $foreach.hasNext ),#end
      #end
      }
      </code></pre>
      <ul>
      <li>Click 'Save'</li>
      </ul>
      </li>
      </ol>
      <h4><a id="user-content-deploy-api-1" class="anchor" href="#deploy-api-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy API</h4>
      <ol>
      <li>Deploy API
      <ul>
      <li>Select <strong>Actions</strong> and select <strong>Deploy API</strong></li>
      <li><strong>Stage Name:</strong> dev</li>
      <li><strong>Stage description:</strong> Pre-production development stage</li>
      </ul>
      </li>
      <li><strong>Remember Invoke URL:</strong> <code>https://......execute-api.us-west-2.amazonaws.com/dev</code></li>
      </ol>
      <h4><a id="user-content-upload-new-lab-page-maptemplhtml-to-website" class="anchor" href="#upload-new-lab-page-maptemplhtml-to-website" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Upload new lab page <code>maptempl.html</code> to website.</h4>
      <ol>
      <li>Edit the file <code>maptempl.html</code> from folder <code>lab-004_mapping_templates</code>
      <ul>
      <li><strong>REPLACE:</strong> <code>MY_API_GW_GET_REQUEST</code></li>
      <li><strong>WITH:</strong> <code>https://......execute-api.us-west-2.amazonaws.com/dev/hello</code></li>
      </ul>
      </li>
      <li>Upload file <code>maptempl.html</code> from folder <code>lab-004_mapping_templates</code> to S3 bucket <code>&lt;your name&gt;.playground11</code>
      <ol>
      <li><strong>Select files</strong>
      <ul>
      <li>(<code>maptempl.html</code>)</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Permissions</strong>
      <ul>
      <li>Manage Group Permissions &gt; Everyone (Read)/Make public</li>
      <li>Click 'Next'</li>
      </ul>
      </li>
      <li><strong>Set Properties</strong>
      <ul>
      <li>Accept defaults, click 'Upload'</li>
      </ul>
      </li>
      </ol>
      </li>
      </ol>
      <h1><a id="user-content-lab-005---kinesis-realtime-data-processing-wth-lambda-dynamodb-and-api-gateway" class="anchor" href="#lab-005---kinesis-realtime-data-processing-wth-lambda-dynamodb-and-api-gateway" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lab-005 - Kinesis, Realtime Data Processing wth Lambda, DynamoDB and API Gateway</h1>
      <p><strong>Goal:</strong> Using AWS Kinesis Streams to create a real-time data reporting using Lambda function to</p>
      <p><strong>AWS Services:</strong> S3, Lambda, API Gateway, Kinesis Streams, DynamoDB</p>
      <div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> lab-005_kinesis
      </pre></div>



    </div>


    <!-- end .grid_24 -->
    <div class="grid_24">
      <hr/>
      <p>
        s3 Sample Static website
      </p>
    </div>
  </div>
</body>
</html>
